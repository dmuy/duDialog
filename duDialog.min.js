/* !Don't remove this!
 * duDialog v1.0 plugin
 * https://github.com/dmuy/duDialog
 *
 * Author: Dionlee Uy
 * Email: dionleeuy@gmail.com
 */
!function(e,t){"function"==typeof define&&define.amd?define("duDialog",[],t(e)):"object"==typeof exports?module.exports=t(e):e.duDialog=t(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function t(){var e={},t=!1,l=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],l++);for(var c=function(l){for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t&&"[object Object]"===Object.prototype.toString.call(l[i])?e[i]=extend(!0,e[i],l[i]):e[i]=l[i])};i>l;l++){var o=arguments[l];c(o)}return e}var l=!!document.querySelector&&!!e.addEventListener,i={init:!1,okText:"Ok",cancelText:"Cancel",selection:!1,multiple:!1,allowSearch:!1,selectedValue:null,valueField:"value",textField:"item",callbacks:null},c=function(){if(!(this instanceof c))return c.apply(Object.create(c.prototype),arguments);var e=this,l=arguments,o=typeof l[0],a=typeof l[1],n=typeof l[2];e.config=t(i,"object"===n?l[2]:l[3]);var r=e.config.selection?e.config.multiple?c.OK_CANCEL:c.NO_ACTION:c.DEFAULT;if(e.type="object"===n?r:l[2]||r,"undefined"===o||"string"!==o&&null!==l[0])throw new Error("Dialog title is missing or incorrect format.");if(("undefined"===a||"string"!==a)&&!e.config.selection||!Array.isArray(l[1])&&e.config.selection)throw new Error("Dialog message is missing or incorrect format.");return e.title=l[0],e.message=l[1],e.cache={},e.config.init||d.apply(e),e},o=function(e,t){var l=function(e,t){for(var i in e){var c=e[i];"object"==typeof c&&null!==c&&void 0===c.dataset&&void 0===c[0]?l(c,t[i]):t[i]=c}};l(t,e)},a=function(e){return e.replace(/\s+/g,"")},n=function(e,t){return e?void 0===e[0]?!1:e.filter(function(e){return e===t}).length>0:!1},d=function(){if(l){var e,t,i,d,r=this,s=r.config.callbacks,g=function(e,t,l,i){var c=document.createElement(e);return c.className=t,"undefined"!=typeof l&&(c[i?"innerHTML":"innerText"]=l),c},p=function(e){if("click"===e.type&&(e.target.matches(".du-dialog")&&(r.type===c.NO_ACTION?r.hide():(r.dialog.classList.add("dlg--pulse"),setTimeout(function(){r.dialog.classList.remove("dlg--pulse")},200))),e.target.matches(".dlg-select-item")&&e.target.querySelector(".dlg-select-lbl").click(),e.target.matches(".dlg-action"))){if(e.target.matches(".ok-action"))if(r.config.selection&&r.config.multiple){for(var t=i.querySelectorAll(":scope .dlg-select-checkbox:checked"),l=[],o=[],a=0;a<t.length;a++){var n=r.cache[t[a].id];o.push(n),l.push("string"==typeof n?t[a].value:n[r.config.valueField])}r.config.selectedValue=l,s.itemSelect.apply({value:l},[e,o]),r.hide()}else s&&s.okClick?s.okClick.apply(r,e):r.hide();e.target.matches(".cancel-action")&&(s&&s.cancelClick?s.cancelClick.apply(r,e):r.hide())}if("change"===e.type&&e.target.matches(".dlg-select-radio")){var d=e.target;if(d.checked&&s&&s.itemSelect){var n=r.cache[d.id];r.config.selectedValue="string"==typeof n?d.value:n[r.config.valueField],s.itemSelect.apply(d,[e,n]),r.hide()}}if("scroll"===e.type&&e.target.matches(".dlg-content")&&e.target.classList[e.target.scrollTop>5?"add":"remove"]("content--scrolled"),"keyup"===e.type&&e.target.matches(".dlg-search"))for(var g=e.target.value,p=i.querySelectorAll(":scope .dlg-select-item"),a=0;a<p.length;a++){var f=p[a],u=f.querySelector(":scope "+(r.config.multiple?".dlg-select-checkbox":".dlg-select-radio")),n=r.cache[u.id],h=typeof n,m="string"===h?n:n[r.config.textField],v=!1;v=s&&s.onSearch?s.onSearch.call(r,n,g):m.toLowerCase().indexOf(g.toLowerCase())>=0,f.classList[v?"remove":"add"]("item--nomatch")}};if(r.docFrag=document.createDocumentFragment(),r.dialog=g("div","du-dialog"),r.docFrag.appendChild(r.dialog),e=g("div","dlg-wrapper"),e.tabIndex=0,r.dialog.appendChild(e),r.title?(t=g("div","dlg-header",r.title),e.appendChild(t)):r.dialog.classList.add("dlg--no-title"),i=g("div","dlg-content"),r.config.selection){if(r.config.allowSearch){var f=g("input","dlg-search");f.placeholder="Search...",t.appendChild(f)}for(var u=0;u<r.message.length;u++){var h=r.message[u],m=typeof h,v="string"===m?h:h[r.config.valueField],y="string"===m?h:h[r.config.textField],b=g("div","dlg-select-item"),C=g("input",r.config.multiple?"dlg-select-checkbox":"dlg-select-radio"),k=g("label","dlg-select-lbl",s&&s.itemRender?s.itemRender.call(r,h):'<span class="select-item">'+y+"</span>",!0),x=(r.config.multiple?"dlg-cb":"dlg-radio")+a(v.toString());o(C,{id:x,name:"dlg-selection",type:r.config.multiple?"checkbox":"radio",value:v,checked:r.config.multiple?r.config.selectedValue&&n(r.config.selectedValue,v):r.config.selectedValue===v}),r.cache[x]=h,k.htmlFor=x,b.appendChild(C),b.appendChild(k),i.appendChild(b)}}else i.innerHTML=r.message;switch(e.appendChild(i),r.type!==c.NO_ACTION&&(d=g("div","dlg-actions"),e.appendChild(d)),r.type){case c.OK_CANCEL:var L=g("button","dlg-action cancel-action",r.config.cancelText),O=g("button","dlg-action ok-action",r.config.okText);L.tabIndex=2,O.tabIndex=1,d.appendChild(L),d.appendChild(O);break;case c.DEFAULT:var O=g("button","dlg-action ok-action",r.config.okText);O.tabIndex=1,d.appendChild(O)}i.addEventListener("scroll",p,!1),r.dialog.addEventListener("click",p,!1),r.dialog.addEventListener("change",p,!1),r.dialog.addEventListener("keyup",p,!1),r.config.init||r.show()}};return Object.defineProperties(c,{DEFAULT:{value:1},OK_CANCEL:{value:2},NO_ACTION:{value:3}}),c.prototype.show=function(){var e=this;e.config.init&&d.apply(this),document.body.appendChild(e.docFrag),setTimeout(function(){if(e.dialog.classList.add("dlg--open"),e.config.selection&&!e.config.multiple){var t=e.dialog.querySelector(":scope .dlg-content"),l=t.querySelector(":scope .dlg-select-radio:checked");if(l){for(var i=Array.prototype.slice.call(t.childNodes),c=0,o=0;o<i.indexOf(l.parentNode);o++){var a=i[o].offsetHeight;c+=a}t.scrollTop=c}}var n=document.getElementsByClassName("dlg-action");n&&n.length?n[n.length-1].focus():e.dialog.getElementsByClassName("dlg-wrapper")[0].focus()},15)},c.prototype.hide=function(){var e=this;e.dialog.classList.add("dlg--closing"),setTimeout(function(){document.body.removeChild(e.dialog)},200)},c});