/* !Don't remove this!
 * duDialog v1.0 plugin
 * https://github.com/dmuy/duDialog
 *
 * Author: Dionlee Uy
 * Email: dionleeuy@gmail.com
 */
!function(e,t){"function"==typeof define&&define.amd?define("duDialog",[],t(e)):"object"==typeof exports?module.exports=t(e):e.duDialog=t(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var t=!!document.querySelector&&!!e.addEventListener,l={id:null,init:!1,okText:"Ok",cancelText:"Cancel",selection:!1,multiple:!1,allowSearch:!1,selectedValue:null,valueField:"value",textField:"item",callbacks:null},c=function(){var e={},t=!1,l=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],l++);for(var i=function(l){for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t&&"[object Object]"===Object.prototype.toString.call(l[o])?e[o]=c(!0,e[o],l[o]):e[o]=l[o])};o>l;l++){var a=arguments[l];i(a)}return e},o=function(){if(!(this instanceof o))return o.apply(Object.create(o.prototype),arguments);var e=this,t=arguments,i=typeof t[0],a=typeof t[1],n=typeof t[2];e.config=c(l,"object"===n?t[2]:t[3]);var r=e.config.selection?e.config.multiple?o.OK_CANCEL:o.NO_ACTION:o.DEFAULT;if(e.type="object"===n?r:t[2]||r,"undefined"===i||"string"!==i&&null!==t[0])throw new Error("Dialog title is missing or incorrect format.");if(("undefined"===a||"string"!==a)&&!e.config.selection||!Array.isArray(t[1])&&e.config.selection)throw new Error("Dialog message is missing or incorrect format.");return e.title=t[0],e.message=t[1],e.cache={},e.config.init||g.apply(e),e},i=function(e,t){var l=function(e,t){for(var c in e){var o=e[c];"object"==typeof o&&null!==o&&void 0===o.dataset&&void 0===o[0]?l(o,t[c]):c in t&&(null!==o?t[c]=o:null!==o?t.setAttribute(c,o):t.removeAttribute(c))}};l(t,e)},a=function(e){return e.replace(/\s+/g,"")},n=function(e,t){return e?void 0===e[0]?!1:e.filter(function(e){return e===t}).length>0:!1},r=function(e,t,l){Array.isArray(e)?e.forEach(function(e){e.addEventListener(t,l,!1)}):e.addEventListener(t,l,!1)},s=function(e,t,l){t.forEach(function(t){e.addEventListener(t,l,!1)})},d=function(e,t){Array.isArray(e)?e.forEach(function(e){t.appendChild(e)}):t.appendChild(e)},g=function(){if(t){var e,l,c,g,f=this,u=f.config.callbacks,p=function(e,t,l,c){var o=document.createElement(e);return"undefined"!=typeof l&&(o[c?"innerHTML":"innerText"]=l),"undefined"!=typeof t&&i(o,t),o},m=function(e){if("click"===e.type&&(e.target.matches(".du-dialog")&&(f.type===o.NO_ACTION?f.hide():(f.dialog.classList.add("dlg--pulse"),setTimeout(function(){f.dialog.classList.remove("dlg--pulse")},200))),e.target.matches(".dlg-select-item")&&e.target.querySelector(".dlg-select-lbl").click(),e.target.matches(".dlg-action"))){if(e.target.matches(".ok-action"))if(f.config.selection&&f.config.multiple){for(var t=c.querySelectorAll(".dlg-select-checkbox:checked"),l=[],i=[],a=0;a<t.length;a++){var n=f.cache[t[a].id];i.push(n),l.push("string"==typeof n?t[a].value:n[f.config.valueField])}f.config.selectedValue=l,u.itemSelect.apply({value:l},[e,i]),f.hide()}else u&&u.okClick?u.okClick.apply(f,e):f.hide();e.target.matches(".cancel-action")&&(u&&u.cancelClick?u.cancelClick.apply(f,e):f.hide())}if("change"===e.type&&e.target.matches(".dlg-select-radio")){var r=e.target;if(r.checked&&u&&u.itemSelect){var n=f.cache[r.id];f.config.selectedValue="string"==typeof n?r.value:n[f.config.valueField],u.itemSelect.apply(r,[e,n]),f.hide()}}if("scroll"===e.type&&e.target.matches(".dlg-content")&&e.target.classList[e.target.scrollTop>5?"add":"remove"]("content--scrolled"),"keyup"===e.type&&e.target.matches(".dlg-search"))for(var s=e.target.value,d=c.querySelectorAll(".dlg-select-item"),a=0;a<d.length;a++){var g=d[a],p=g.querySelector(f.config.multiple?".dlg-select-checkbox":".dlg-select-radio"),n=f.cache[p.id],m=typeof n,h="string"===m?n:n[f.config.textField],y=!1;y=u&&u.onSearch?u.onSearch.call(f,n,s):h.toLowerCase().indexOf(s.toLowerCase())>=0,g.classList[y?"remove":"add"]("item--nomatch")}};if(f.docFrag=document.createDocumentFragment(),f.dialog=p("div",{className:"du-dialog",id:f.config.id}),d(f.dialog,f.docFrag),e=p("div",{className:"dlg-wrapper",tabIndex:0}),d(e,f.dialog),f.title?(l=p("div",{className:"dlg-header"},f.title),d(l,e)):f.dialog.classList.add("dlg--no-title"),c=p("div",{className:"dlg-content"}),f.config.selection){f.config.allowSearch&&d(p("input",{className:"dlg-search",placeholder:"Search..."}),l);for(var h=0;h<f.message.length;h++){var y=f.message[h],v=typeof y,b="string"===v?y:y[f.config.valueField],k="string"===v?y:y[f.config.textField],N=(f.config.multiple?"dlg-cb":"dlg-radio")+a(b.toString()),E=p("div",{className:"dlg-select-item"}),S=p("input",{className:f.config.multiple?"dlg-select-checkbox":"dlg-select-radio",id:N,name:"dlg-selection",type:f.config.multiple?"checkbox":"radio",value:b,checked:f.config.multiple?f.config.selectedValue&&n(f.config.selectedValue,b):f.config.selectedValue===b}),A=p("label",{className:"dlg-select-lbl",htmlFor:N},u&&u.itemRender?u.itemRender.call(f,y):'<span class="select-item">'+k+"</span>",!0);f.cache[N]=y,d([S,A],E),d(E,c)}}else c.innerHTML=f.message;switch(d(c,e),f.type!==o.NO_ACTION&&(g=p("div",{className:"dlg-actions"}),d(g,e)),f.type){case o.OK_CANCEL:d([p("button",{className:"dlg-action cancel-action",tabIndex:2},f.config.cancelText),p("button",{className:"dlg-action ok-action",tabIndex:1},f.config.okText)],g);break;case o.DEFAULT:d(p("button",{className:"dlg-action ok-action",tabIndex:1},f.config.okText),g)}r(c,"scroll",m),s(f.dialog,["click","change","keyup"],m),f.config.init||f.show()}};return Object.defineProperties(o,{DEFAULT:{value:1},OK_CANCEL:{value:2},NO_ACTION:{value:3}}),o.prototype.show=function(){var e=this;e.config.init&&g.apply(this),d(e.docFrag,document.body),setTimeout(function(){if(e.dialog.classList.add("dlg--open"),e.config.selection&&!e.config.multiple){var t=e.dialog.querySelector(".dlg-content"),l=t.querySelector(".dlg-select-radio:checked");if(l){for(var c=Array.prototype.slice.call(t.childNodes),o=0,i=0;i<c.indexOf(l.parentNode);i++){var a=c[i].offsetHeight;o+=a}t.scrollTop=o}}var n=document.getElementsByClassName("dlg-action");n&&n.length?n[n.length-1].focus():e.dialog.getElementsByClassName("dlg-wrapper")[0].focus()},15)},o.prototype.hide=function(){var e=this;e.dialog.classList.add("dlg--closing"),setTimeout(function(){document.body.removeChild(e.dialog)},200)},o}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),l=t.length;--l>=0&&t.item(l)!==this;);return l>-1});