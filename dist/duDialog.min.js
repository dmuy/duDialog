!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).duDialog=t()}(this,function(){"use strict";function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var A={defaults:{id:null,init:!1,dark:!1,buttons:1,okText:"Ok",cancelText:"Cancel",selection:!1,multiple:!1,minSelect:1,maxSelect:null,allowSearch:!1,selectedValue:null,valueField:"value",textField:"item",callbacks:null},buttons:{DEFAULT:1,OK_CANCEL:2,NONE:0}};function N(e,t){Array.isArray(e)?e.forEach(function(e){t.appendChild(e)}):t.appendChild(e)}function w(e,t,o,n){var l=document.createElement(e);return void 0!==o&&(l[n?"innerHTML":"innerText"]=o),void 0!==t&&function e(t,o){for(var n in t){var l=t[n];"object"===E(l)&&null!==l&&void 0===l.dataset&&void 0===l[0]?e(l,o[n]):n in o&&(null!==l?o[n]=l:null!==l?o.setAttribute(n,l):o.removeAttribute(n))}}(t,l),l}function r(){function g(){h.dialog.classList.add("dlg--pulse"),setTimeout(function(){h.dialog.classList.remove("dlg--pulse")},200)}function m(){p.querySelectorAll(".dlg-select-checkbox:checked").length===h.config.maxSelect?(p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.setAttribute("disabled",!0),e.parentNode.classList.add("item--disabled")}),y&&y.maxReached&&y.maxReached.call(h,h.config.maxSelect)):p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.removeAttribute("disabled"),e.parentNode.classList.remove("item--disabled")})}function e(e){if("click"===e.type&&(e.target.matches(".du-dialog")&&(h.type===A.buttons.NONE?h.hide():g()),e.target.matches(".dlg-select-item")&&e.target.querySelector(".dlg-select-lbl").click(),e.target.matches(".dlg-action"))){if(e.target.matches(".ok-action"))if(h.config.selection&&h.config.multiple){for(var t=p.querySelectorAll(".dlg-select-checkbox:checked"),o=[],n=[],l=0;l<t.length;l++){var c=h.cache[t[l].id];n.push(c),o.push("string"==typeof c?t[l].value:c[h.config.valueField])}o.length>=h.config.minSelect?(h.config.selectedValue=o,y&&y.itemSelect&&(y.itemSelect.apply({value:o},[e,n]),h.hide())):(g(),y&&y.minRequired&&y.minRequired.call(h,h.config.minSelect))}else y&&y.okClick?y.okClick.apply(h,e):h.hide();e.target.matches(".cancel-action")&&(y&&y.cancelClick?y.cancelClick.apply(h,e):h.hide())}var i;if("change"===e.type&&(e.target.matches(".dlg-select-radio")?(i=e.target).checked&&y&&y.itemSelect&&(c=h.cache[i.id],h.config.selectedValue="string"==typeof c?i.value:c[h.config.valueField],y.itemSelect.apply(i,[e,c]),h.hide()):e.target.matches(".dlg-select-checkbox")&&h.config.maxSelect&&m()),"scroll"===e.type&&e.target.matches(".dlg-content")&&e.target.classList[5<e.target.scrollTop?"add":"remove"]("content--scrolled"),"keyup"===e.type&&e.target.matches(".dlg-search"))for(var a=e.target.value,r=p.querySelectorAll(".dlg-select-item"),l=0;l<r.length;l++){var s=r[l],d=s.querySelector(h.config.multiple?".dlg-select-checkbox":".dlg-select-radio"),u="string"===E(c=h.cache[d.id])?c:c[h.config.textField],f=y&&y.onSearch?y.onSearch.call(h,c,a):0<=u.toLowerCase().indexOf(a.toLowerCase());s.classList[f?"remove":"add"]("item--nomatch")}}var t,o,p,n,l,c,i,a,r,h=this,y=h.config.callbacks;if(h.docFrag=document.createDocumentFragment(),h.dialog=w("div",{className:"du-dialog",id:h.config.id}),h.config.dark&&h.dialog.setAttribute("dark",!0),h.config.selection&&h.dialog.setAttribute("selection",!0),N(h.dialog,h.docFrag),N(t=w("div",{className:"dlg-wrapper",tabIndex:0}),h.dialog),h.title?N(o=w("div",{className:"dlg-header"},h.title),t):h.dialog.classList.add("dlg--no-title"),p=w("div",{className:"dlg-content"}),h.config.selection){h.config.allowSearch&&N(w("input",{className:"dlg-search",placeholder:"Search..."}),o);for(var s=0;s<h.content.length;s++){var d=h.content[s],u=E(d),f="string"===u?d:d[h.config.valueField],b="string"===u?d:d[h.config.textField],v=(h.config.multiple?"dlg-cb":"dlg-radio")+f.toString().replace(/\s+/g,""),S=w("div",{className:"dlg-select-item"}),k=w("input",{className:h.config.multiple?"dlg-select-checkbox":"dlg-select-radio",id:v,name:"dlg-selection",type:h.config.multiple?"checkbox":"radio",value:f,checked:h.config.multiple?h.config.selectedValue&&function(e,t){return!!e&&(void 0!==e[0]&&0<e.filter(function(e){return e===t}).length)}(h.config.selectedValue,f):h.config.selectedValue===f}),x=w("label",{className:"dlg-select-lbl",htmlFor:v},y&&y.itemRender?y.itemRender.call(h,d):'<span class="select-item">'+b+"</span>",!0);h.cache[v]=d,N([k,x],S),N(S,p)}h.config.multiple&&h.config.maxSelect&&m()}else p.innerHTML=h.content;switch(N(p,t),h.type!==A.buttons.NONE&&N(n=w("div",{className:"dlg-actions"}),t),h.type){case A.buttons.OK_CANCEL:N([w("button",{className:"dlg-action cancel-action",tabIndex:2},h.config.cancelText),w("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText)],n);break;case A.buttons.DEFAULT:N(w("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText),n)}l=p,c="scroll",i=e,Array.isArray(l)?l.forEach(function(e){e.addEventListener(c,i,!1)}):l.addEventListener(c,i,!1),a=h.dialog,r=e,["click","change","keyup"].forEach(function(e){a.addEventListener(e,r,!1)}),h.config.init||h.show()}var c=function(){function i(e,t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=this,l=E(e),c=E(t);if(n.config=function o(e){var n={},l=!1,t=0,c=arguments.length;"[object Boolean]"===Object.prototype.toString.call(e)&&(l=e,t++);for(;t<c;t++)!function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(l&&"[object Object]"===Object.prototype.toString.call(e[t])?n[t]=o(!0,n[t],e[t]):n[t]=e[t])}(arguments[t]);return n}(!0,A.defaults,o),n.type=n.config.selection?n.config.multiple?A.buttons.OK_CANCEL:A.buttons.NONE:n.config.buttons,"undefined"===l||"string"!==l&&null!==e)throw new Error("Dialog title is missing or incorrect format.");if(("undefined"===c||"string"!==c)&&!n.config.selection||!Array.isArray(t)&&n.config.selection)throw new Error("Dialog message is missing or incorrect format.");n.title=e,n.content=t,n.cache={},n.config.init||r.apply(n)}var e,t,o;return e=i,(t=[{key:"show",value:function(){var i=this;i.config.init&&r.apply(i),N(i.docFrag,document.body),setTimeout(function(){if(i.dialog.classList.add("dlg--open"),i.config.selection&&!i.config.multiple){var e=i.dialog.querySelector(".dlg-content"),t=e.querySelector(".dlg-select-radio:checked");if(t){for(var o=a(e.childNodes),n=0,l=0;l<o.indexOf(t.parentNode);l++){n+=o[l].offsetHeight}e.scrollTop=n}}var c=document.getElementsByClassName("dlg-action");c&&c.length?c[c.length-1].focus():i.dialog.getElementsByClassName("dlg-wrapper")[0].focus()},15)}},{key:"hide",value:function(){var e=this;e.dialog.classList.add("dlg--closing"),setTimeout(function(){document.body.removeChild(e.dialog)},200)}}])&&n(e.prototype,t),o&&n(e,o),i}();function e(e,t,o){return new c(e,t,o)}return function(e){var t,o={},n=A.buttons;for(t in n)o[t]={value:n[t]};Object.defineProperties(e,o)}(e),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),o=t.length;0<=--o&&t.item(o)!==this;);return-1<o}),e});