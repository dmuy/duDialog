!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).duDialog=t()}(this,function(){"use strict";function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var E={defaults:{id:null,init:!1,dark:!1,buttons:1,okText:"Ok",yesText:"Yes",noText:"No",cancelText:"Cancel",selection:!1,multiple:!1,minSelect:1,maxSelect:null,allowSearch:!1,selectedValue:null,valueField:"value",textField:"item",callbacks:null},buttons:{DEFAULT:1,OK_CANCEL:2,YES_NO_CANCEL:3,NONE:0}};function A(e,t){Array.isArray(e)?e.forEach(function(e){t.appendChild(e)}):t.appendChild(e)}function C(e,t,n,o){var c=document.createElement(e);return void 0!==n&&(c[o?"innerHTML":"innerText"]=n),void 0!==t&&function e(t,n){for(var o in t){var c=t[o];"object"===N(c)&&null!==c&&void 0===c.dataset&&void 0===c[0]?e(c,n[o]):o in n&&(null!==c?n[o]=c:null!==c?n.setAttribute(o,c):n.removeAttribute(o))}}(t,c),c}function r(){function f(){h.dialog.classList.add("dlg--pulse"),setTimeout(function(){h.dialog.classList.remove("dlg--pulse")},200)}function m(){p.querySelectorAll(".dlg-select-checkbox:checked").length===h.config.maxSelect?(p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.setAttribute("disabled",!0),e.parentNode.classList.add("item--disabled")}),y&&y.maxReached&&y.maxReached.call(h,h.config.maxSelect)):p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.removeAttribute("disabled"),e.parentNode.classList.remove("item--disabled")})}function e(e){if("click"===e.type&&(e.target.matches(".du-dialog")&&(h.type===E.buttons.NONE?h.hide():f()),e.target.matches(".dlg-select-item")&&e.target.querySelector(".dlg-select-lbl").click(),e.target.matches(".dlg-action"))){if(e.target.matches(".ok-action"))if(h.config.selection&&h.config.multiple){for(var t=p.querySelectorAll(".dlg-select-checkbox:checked"),n=[],o=[],c=0;c<t.length;c++){var l=h.cache[t[c].id];o.push(l),n.push("string"==typeof l?t[c].value:l[h.config.valueField])}n.length>=h.config.minSelect?(h.config.selectedValue=n,y&&y.itemSelect&&(y.itemSelect.apply({value:n},[e,o]),h.hide())):(f(),y&&y.minRequired&&y.minRequired.call(h,h.config.minSelect))}else y&&y.okClick?y.okClick.apply(h,e):h.hide();e.target.matches(".yes-action")&&(y&&y.yesClick?y.yesClick.apply(h,e):h.hide()),e.target.matches(".no-action")&&(y&&y.noClick?y.noClick.apply(h,e):h.hide()),e.target.matches(".cancel-action")&&(y&&y.cancelClick?y.cancelClick.apply(h,e):h.hide())}var i;if("change"===e.type&&(e.target.matches(".dlg-select-radio")?(i=e.target).checked&&y&&y.itemSelect&&(l=h.cache[i.id],h.config.selectedValue="string"==typeof l?i.value:l[h.config.valueField],y.itemSelect.apply(i,[e,l]),h.hide()):e.target.matches(".dlg-select-checkbox")&&h.config.maxSelect&&m()),"scroll"===e.type&&e.target.matches(".dlg-content")&&e.target.classList[5<e.target.scrollTop?"add":"remove"]("content--scrolled"),"keyup"===e.type&&e.target.matches(".dlg-search"))for(var a=e.target.value,r=p.querySelectorAll(".dlg-select-item"),c=0;c<r.length;c++){var s=r[c],d=s.querySelector(h.config.multiple?".dlg-select-checkbox":".dlg-select-radio"),u="string"===N(l=h.cache[d.id])?l:l[h.config.textField],g=y&&y.onSearch?y.onSearch.call(h,l,a):0<=u.toLowerCase().indexOf(a.toLowerCase());s.classList[g?"remove":"add"]("item--nomatch")}}var t,n,p,o,c,l,i,a,r,h=this,y=h.config.callbacks;if(h.docFrag=document.createDocumentFragment(),h.dialog=C("div",{className:"du-dialog",id:h.config.id}),h.config.dark&&h.dialog.setAttribute("dark",!0),h.config.selection&&h.dialog.setAttribute("selection",!0),A(h.dialog,h.docFrag),A(t=C("div",{className:"dlg-wrapper",tabIndex:0}),h.dialog),h.title?A(n=C("div",{className:"dlg-header"},h.title),t):h.dialog.classList.add("dlg--no-title"),p=C("div",{className:"dlg-content"}),h.config.selection){h.config.allowSearch&&A(C("input",{className:"dlg-search",placeholder:"Search..."}),n);for(var s=0;s<h.content.length;s++){var d=h.content[s],u=N(d),g="string"===u?d:d[h.config.valueField],b="string"===u?d:d[h.config.textField],v=(h.config.multiple?"dlg-cb":"dlg-radio")+g.toString().replace(/\s+/g,""),k=C("div",{className:"dlg-select-item"}),S=C("input",{className:h.config.multiple?"dlg-select-checkbox":"dlg-select-radio",id:v,name:"dlg-selection",type:h.config.multiple?"checkbox":"radio",value:g,checked:h.config.multiple?h.config.selectedValue&&function(e,t){return!!e&&(void 0!==e[0]&&0<e.filter(function(e){return e===t}).length)}(h.config.selectedValue,g):h.config.selectedValue===g}),x=C("label",{className:"dlg-select-lbl",htmlFor:v},y&&y.itemRender?y.itemRender.call(h,d):'<span class="select-item">'+b+"</span>",!0);h.cache[v]=d,A([S,x],k),A(k,p)}h.config.multiple&&h.config.maxSelect&&m()}else p.innerHTML=h.content;switch(A(p,t),h.type!==E.buttons.NONE&&A(o=C("div",{className:"dlg-actions"}),t),h.type){case E.buttons.OK_CANCEL:A([C("button",{className:"dlg-action cancel-action",tabIndex:2},h.config.cancelText),C("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText)],o);break;case E.buttons.YES_NO_CANCEL:A([C("button",{className:"dlg-action cancel-action",tabIndex:3},h.config.cancelText),C("button",{className:"dlg-action no-action",tabIndex:2},h.config.noText),C("button",{className:"dlg-action yes-action",tabIndex:1},h.config.yesText)],o);break;case E.buttons.DEFAULT:A(C("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText),o)}c=p,l="scroll",i=e,Array.isArray(c)?c.forEach(function(e){e.addEventListener(l,i,!1)}):c.addEventListener(l,i,!1),a=h.dialog,r=e,["click","change","keyup"].forEach(function(e){a.addEventListener(e,r,!1)}),h.config.init||h.show()}var l=function(){function i(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var o=this,c=N(e),l=N(t);if(o.config=function n(e){var o={},c=!1,t=0,l=arguments.length;"[object Boolean]"===Object.prototype.toString.call(e)&&(c=e,t++);for(;t<l;t++)!function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(c&&"[object Object]"===Object.prototype.toString.call(e[t])?o[t]=n(!0,o[t],e[t]):o[t]=e[t])}(arguments[t]);return o}(!0,E.defaults,n),o.type=o.config.selection?o.config.multiple?E.buttons.OK_CANCEL:E.buttons.NONE:o.config.buttons,"undefined"===c||"string"!==c&&null!==e)throw new Error("Dialog title is missing or incorrect format.");if(("undefined"===l||"string"!==l)&&!o.config.selection||!Array.isArray(t)&&o.config.selection)throw new Error("Dialog message is missing or incorrect format.");o.title=e,o.content=t,o.cache={},o.config.init||r.apply(o)}var e,t,n;return e=i,(t=[{key:"show",value:function(){var i=this;i.config.init&&r.apply(i),A(i.docFrag,document.body),setTimeout(function(){if(i.dialog.classList.add("dlg--open"),i.config.selection&&!i.config.multiple){var e=i.dialog.querySelector(".dlg-content"),t=e.querySelector(".dlg-select-radio:checked");if(t){for(var n=a(e.childNodes),o=0,c=0;c<n.indexOf(t.parentNode);c++){o+=n[c].offsetHeight}e.scrollTop=o}}var l=document.getElementsByClassName("dlg-action");l&&l.length?l[l.length-1].focus():i.dialog.getElementsByClassName("dlg-wrapper")[0].focus()},15)}},{key:"hide",value:function(){var e=this;e.dialog.classList.add("dlg--closing"),setTimeout(function(){document.body.removeChild(e.dialog)},200)}}])&&o(e.prototype,t),n&&o(e,n),i}();function e(e,t,n){return new l(e,t,n)}return function(e){var t,n={},o=E.buttons;for(t in o)n[t]={value:o[t]};Object.defineProperties(e,n)}(e),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n}),e});