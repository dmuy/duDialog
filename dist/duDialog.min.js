!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).duDialog=t()}(this,function(){"use strict";function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t,o){return(c=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,o){var n=[null];n.push.apply(n,t);var c=new(Function.bind.apply(e,n));return o&&l(c,o.prototype),c}).apply(null,arguments)}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var x={defaults:{id:null,init:!1,dark:!1,okText:"Ok",cancelText:"Cancel",selection:!1,multiple:!1,minSelect:1,maxSelect:null,allowSearch:!1,selectedValue:null,valueField:"value",textField:"item",callbacks:null},buttons:{DEFAULT:1,OK_CANCEL:2,NO_ACTION:3}};function E(e,t){Array.isArray(e)?e.forEach(function(e){t.appendChild(e)}):t.appendChild(e)}function O(e,t,o,n){var c=document.createElement(e);return void 0!==o&&(c[n?"innerHTML":"innerText"]=o),void 0!==t&&function e(t,o){for(var n in t){var c=t[n];"object"===N(c)&&null!==c&&void 0===c.dataset&&void 0===c[0]?e(c,o[n]):n in o&&(null!==c?o[n]=c:null!==c?o.setAttribute(n,c):o.removeAttribute(n))}}(t,c),c}function a(){function g(){h.dialog.classList.add("dlg--pulse"),setTimeout(function(){h.dialog.classList.remove("dlg--pulse")},200)}function m(){p.querySelectorAll(".dlg-select-checkbox:checked").length===h.config.maxSelect?(p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.setAttribute("disabled",!0),e.parentNode.classList.add("item--disabled")}),y&&y.maxReached&&y.maxReached.call(h,h.config.maxSelect)):p.querySelectorAll(".dlg-select-checkbox:not(:checked)").forEach(function(e){e.removeAttribute("disabled"),e.parentNode.classList.remove("item--disabled")})}function e(e){if("click"===e.type&&(e.target.matches(".du-dialog")&&(h.type===x.buttons.NO_ACTION?h.hide():g()),e.target.matches(".dlg-select-item")&&e.target.querySelector(".dlg-select-lbl").click(),e.target.matches(".dlg-action"))){if(e.target.matches(".ok-action"))if(h.config.selection&&h.config.multiple){for(var t=p.querySelectorAll(".dlg-select-checkbox:checked"),o=[],n=[],c=0;c<t.length;c++){var l=h.cache[t[c].id];n.push(l),o.push("string"==typeof l?t[c].value:l[h.config.valueField])}o.length>=h.config.minSelect?(h.config.selectedValue=o,y.itemSelect.apply({value:o},[e,n]),h.hide()):(g(),y&&y.minRequired&&y.minRequired.call(h,h.config.minSelect))}else y&&y.okClick?y.okClick.apply(h,e):h.hide();e.target.matches(".cancel-action")&&(y&&y.cancelClick?y.cancelClick.apply(h,e):h.hide())}var i;if("change"===e.type&&(e.target.matches(".dlg-select-radio")?(i=e.target).checked&&y&&y.itemSelect&&(l=h.cache[i.id],h.config.selectedValue="string"==typeof l?i.value:l[h.config.valueField],y.itemSelect.apply(i,[e,l]),h.hide()):e.target.matches(".dlg-select-checkbox")&&h.config.maxSelect&&m()),"scroll"===e.type&&e.target.matches(".dlg-content")&&e.target.classList[5<e.target.scrollTop?"add":"remove"]("content--scrolled"),"keyup"===e.type&&e.target.matches(".dlg-search"))for(var r=e.target.value,a=p.querySelectorAll(".dlg-select-item"),c=0;c<a.length;c++){var s=a[c],d=s.querySelector(h.config.multiple?".dlg-select-checkbox":".dlg-select-radio"),u="string"===N(l=h.cache[d.id])?l:l[h.config.textField],f=y&&y.onSearch?y.onSearch.call(h,l,r):0<=u.toLowerCase().indexOf(r.toLowerCase());s.classList[f?"remove":"add"]("item--nomatch")}}var t,o,p,n,c,l,i,r,a,h=this,y=h.config.callbacks;if(h.docFrag=document.createDocumentFragment(),h.dialog=O("div",{className:"du-dialog",id:h.config.id}),h.config.dark&&h.dialog.setAttribute("dark",!0),h.config.selection&&h.dialog.setAttribute("selection",!0),E(h.dialog,h.docFrag),E(t=O("div",{className:"dlg-wrapper",tabIndex:0}),h.dialog),h.title?E(o=O("div",{className:"dlg-header"},h.title),t):h.dialog.classList.add("dlg--no-title"),p=O("div",{className:"dlg-content"}),h.config.selection){h.config.allowSearch&&E(O("input",{className:"dlg-search",placeholder:"Search..."}),o);for(var s=0;s<h.message.length;s++){var d=h.message[s],u=N(d),f="string"===u?d:d[h.config.valueField],b="string"===u?d:d[h.config.textField],v=(h.config.multiple?"dlg-cb":"dlg-radio")+f.toString().replace(/\s+/g,""),S=O("div",{className:"dlg-select-item"}),k=O("input",{className:h.config.multiple?"dlg-select-checkbox":"dlg-select-radio",id:v,name:"dlg-selection",type:h.config.multiple?"checkbox":"radio",value:f,checked:h.config.multiple?h.config.selectedValue&&function(e,t){return!!e&&(void 0!==e[0]&&0<e.filter(function(e){return e===t}).length)}(h.config.selectedValue,f):h.config.selectedValue===f}),A=O("label",{className:"dlg-select-lbl",htmlFor:v},y&&y.itemRender?y.itemRender.call(h,d):'<span class="select-item">'+b+"</span>",!0);h.cache[v]=d,E([k,A],S),E(S,p)}h.config.multiple&&h.config.maxSelect&&m()}else p.innerHTML=h.message;switch(E(p,t),h.type!==x.buttons.NO_ACTION&&E(n=O("div",{className:"dlg-actions"}),t),h.type){case x.buttons.OK_CANCEL:E([O("button",{className:"dlg-action cancel-action",tabIndex:2},h.config.cancelText),O("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText)],n);break;case x.buttons.DEFAULT:E(O("button",{className:"dlg-action ok-action",tabIndex:1},h.config.okText),n)}c=p,l="scroll",i=e,Array.isArray(c)?c.forEach(function(e){e.addEventListener(l,i,!1)}):c.addEventListener(l,i,!1),r=h.dialog,a=e,["click","change","keyup"].forEach(function(e){r.addEventListener(e,a,!1)}),h.config.init||h.show()}var s=function(){function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=this,t=arguments,o=N(t[0]),n=N(t[1]),c=N(t[2]);e.config=function o(e){var n={},c=!1,t=0,l=arguments.length;"[object Boolean]"===Object.prototype.toString.call(e)&&(c=e,t++);for(;t<l;t++)!function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(c&&"[object Object]"===Object.prototype.toString.call(e[t])?n[t]=o(!0,n[t],e[t]):n[t]=e[t])}(arguments[t]);return n}(!0,x.defaults,"object"===c?t[2]:t[3]);var l=e.config.selection?e.config.multiple?x.buttons.OK_CANCEL:x.buttons.NO_ACTION:x.buttons.DEFAULT;if(e.type="object"!==c&&t[2]||l,"undefined"===o||"string"!==o&&null!==t[0])throw new Error("Dialog title is missing or incorrect format.");if(("undefined"===n||"string"!==n)&&!e.config.selection||!Array.isArray(t[1])&&e.config.selection)throw new Error("Dialog message is missing or incorrect format.");e.title=t[0],e.message=t[1],e.cache={},e.config.init||a.apply(e)}var e,t,o;return e=i,(t=[{key:"show",value:function(){var i=this;i.config.init&&a.apply(i),E(i.docFrag,document.body),setTimeout(function(){if(i.dialog.classList.add("dlg--open"),i.config.selection&&!i.config.multiple){var e=i.dialog.querySelector(".dlg-content"),t=e.querySelector(".dlg-select-radio:checked");if(t){for(var o=r(e.childNodes),n=0,c=0;c<o.indexOf(t.parentNode);c++){n+=o[c].offsetHeight}e.scrollTop=n}}var l=document.getElementsByClassName("dlg-action");l&&l.length?l[l.length-1].focus():i.dialog.getElementsByClassName("dlg-wrapper")[0].focus()},15)}},{key:"hide",value:function(){var e=this;e.dialog.classList.add("dlg--closing"),setTimeout(function(){document.body.removeChild(e.dialog)},200)}}])&&n(e.prototype,t),o&&n(e,o),i}();function e(e,t,o,n){return c(s,Array.prototype.slice.call(arguments))}return Object.defineProperties(e,{DEFAULT:{value:x.buttons.DEFAULT},OK_CANCEL:{value:x.buttons.OK_CANCEL},NO_ACTION:{value:x.buttons.NO_ACTION}}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),o=t.length;0<=--o&&t.item(o)!==this;);return-1<o}),e});